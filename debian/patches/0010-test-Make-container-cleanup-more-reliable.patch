From 871c8d1e5ca475008ebab876c7db48e445e5415d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?St=C3=A9phane=20Graber?= <stgraber@ubuntu.com>
Date: Fri, 30 Sep 2016 22:20:55 -0400
Subject: test: Make container cleanup more reliable
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

With --fast, a container with multiple IPs won't result in an empty
string being considered as a container name.

Signed-off-by: St√©phane Graber <stgraber@ubuntu.com>
---
 test/main.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/test/main.sh b/test/main.sh
index 5afa7f9..d6f30fe 100755
--- a/test/main.sh
+++ b/test/main.sh
@@ -214,7 +214,7 @@ kill_lxd() {
   if [ -e "${daemon_dir}/unix.socket" ]; then
     # Delete all containers
     echo "==> Deleting all containers"
-    for container in $(lxc list --force-local | tail -n+3 | grep "^| " | cut -d' ' -f2); do
+    for container in $(lxc list --fast --force-local | tail -n+3 | grep "^| " | cut -d' ' -f2); do
       lxc delete "${container}" --force-local -f || true
     done
 
