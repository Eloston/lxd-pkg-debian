From 1f1fd9d053901798a4051a9b1858aa10db328078 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?St=C3=A9phane=20Graber?= <stgraber@ubuntu.com>
Date: Wed, 28 Jun 2017 14:47:05 -0400
Subject: Fix failure to launch containers with random names
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: St√©phane Graber <stgraber@ubuntu.com>
---
 lxc/init.go          | 3 ++-
 test/suites/basic.sh | 4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/lxc/init.go b/lxc/init.go
index 1a7934e3..254da695 100644
--- a/lxc/init.go
+++ b/lxc/init.go
@@ -310,7 +310,8 @@ func (c *initCmd) create(conf *config.Config, args []string) (lxd.ContainerServe
 
 	if len(containers) == 1 && name == "" {
 		fields := strings.Split(containers[0], "/")
-		fmt.Printf(i18n.G("Container name is: %s")+"\n", fields[len(fields)-1])
+		name = fields[len(fields)-1]
+		fmt.Printf(i18n.G("Container name is: %s")+"\n", name)
 	}
 
 	// Validate the network setup
diff --git a/test/suites/basic.sh b/test/suites/basic.sh
index 318303be..19b7885e 100644
--- a/test/suites/basic.sh
+++ b/test/suites/basic.sh
@@ -201,9 +201,9 @@ test_basic_usage() {
   [ ! -d "${LXD_DIR}/snapshots/bar" ]
 
   # Test randomly named container creation
-  lxc init testimage
+  lxc launch testimage
   RDNAME=$(lxc list | tail -n2 | grep ^\| | awk '{print $2}')
-  lxc delete "${RDNAME}"
+  lxc delete -f "${RDNAME}"
 
   # Test "nonetype" container creation
   wait_for "${LXD_ADDR}" my_curl -X POST "https://${LXD_ADDR}/1.0/containers" \
