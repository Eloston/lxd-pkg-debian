From af4ba58c97618ebf33625e3655dd819dff0338fa Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?St=C3=A9phane=20Graber?= <stgraber@ubuntu.com>
Date: Wed, 20 Sep 2017 17:50:53 -0400
Subject: networks: Update dnsmasq on container renames
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: St√©phane Graber <stgraber@ubuntu.com>
---
 lxd/container_lxc.go | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/lxd/container_lxc.go b/lxd/container_lxc.go
index e9fbb130..0a7320e0 100644
--- a/lxd/container_lxc.go
+++ b/lxd/container_lxc.go
@@ -3039,6 +3039,9 @@ func (c *containerLXC) Rename(newName string) error {
 	// Invalidate the go-lxc cache
 	c.c = nil
 
+	// Update lease files
+	networkUpdateStatic(c.state, "")
+
 	logger.Info("Renamed container", ctxMap)
 
 	return nil
