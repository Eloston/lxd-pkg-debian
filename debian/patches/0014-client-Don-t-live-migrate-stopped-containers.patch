From 53c6e59a0aeb914506f9ae21c32ec1e050e2950a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?St=C3=A9phane=20Graber?= <stgraber@ubuntu.com>
Date: Mon, 3 Jul 2017 01:25:39 -0400
Subject: client: Don't live migrate stopped containers
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: St√©phane Graber <stgraber@ubuntu.com>
---
 client/lxd_containers.go | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/lxd_containers.go b/client/lxd_containers.go
index e8d03a14..c2362423 100644
--- a/client/lxd_containers.go
+++ b/client/lxd_containers.go
@@ -203,7 +203,6 @@ func (r *ProtocolLXD) CopyContainer(source ContainerServer, container api.Contai
 		ContainerPut: container.Writable(),
 	}
 	req.Source.BaseImage = container.Config["volatile.base_image"]
-	req.Source.Live = container.StatusCode == api.Running
 
 	// Process the copy arguments
 	if args != nil {
@@ -221,6 +220,10 @@ func (r *ProtocolLXD) CopyContainer(source ContainerServer, container api.Contai
 		req.Source.ContainerOnly = args.ContainerOnly
 	}
 
+	if req.Source.Live {
+		req.Source.Live = container.StatusCode == api.Running
+	}
+
 	// Optimization for the local copy case
 	if r == source {
 		// Local copy source fields
