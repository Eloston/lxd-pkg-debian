From 58078e705df21819c28563fd91f95b902efc48db Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?St=C3=A9phane=20Graber?= <stgraber@ubuntu.com>
Date: Fri, 24 Feb 2017 13:23:59 -0500
Subject: btrfs: Quotas can't be enabled when unprivileged
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

But lets try anyway just in case it becomes possible.

Signed-off-by: St√©phane Graber <stgraber@ubuntu.com>
---
 lxd/storage_btrfs.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lxd/storage_btrfs.go b/lxd/storage_btrfs.go
index 36fa57a..4da913f 100644
--- a/lxd/storage_btrfs.go
+++ b/lxd/storage_btrfs.go
@@ -199,7 +199,7 @@ func (s *storageBtrfs) StoragePoolCreate() error {
 	// Enable quotas
 	output, err := exec.Command(
 		"btrfs", "quota", "enable", poolMntPoint).CombinedOutput()
-	if err != nil {
+	if err != nil && !runningInUserns {
 		return fmt.Errorf("Failed to enable quotas on BTRFS pool: %s", output)
 	}
 
